<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Model and account for (or remove) the effect of meteorology
    on atmospheric composition data. The technique uses boosted regression
    trees based on the gbm package. Code can also be run using multiple
    cores if available.">
<title>Remove the influence of weather on air quality data • deweather</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Remove the influence of weather on air quality data">
<meta property="og:description" content="Model and account for (or remove) the effect of meteorology
    on atmospheric composition data. The technique uses boosted regression
    trees based on the gbm package. Code can also be run using multiple
    cores if available.">
<meta property="og:image" content="https://davidcarslaw.github.io/deweather/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">deweather</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.2.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">News</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-case-studies-external-">Case Studies (External)</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-case-studies-external-">
    <a class="external-link dropdown-item" href="https://www.sciencedirect.com/science/article/pii/S004896971834244X">(2019) Using meteorological normalisation to detect interventions in air quality time series</a>
    <a class="external-link dropdown-item" href="https://www.sciencedirect.com/science/article/abs/pii/S1352231012001355">(2012) A short-term intervention study — Impact of airport closure due to the eruption of Eyjafjallajökull on near-field air quality</a>
    <a class="external-link dropdown-item" href="https://www.sciencedirect.com/science/article/abs/pii/S1352231009003069">(2009) Analysis of air pollution data at a mixed source location using boosted regression trees</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/davidcarslaw/deweather">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="deweather-remove-meteorological-variation-from-air-quality-data-">deweather: remove meteorological variation from air quality data 
<a class="anchor" aria-label="anchor" href="#deweather-remove-meteorological-variation-from-air-quality-data-"></a>
</h1>
</div>
<!-- badges: start -->

<p><strong>deweather</strong> is an R package developed for the purpose of “removing” the influence of meteorology from air quality time series data. It is part of the <a href="http://davidcarslaw.github.io/openair/" class="external-link">openair</a> suite of packages designed to support the analysis of air quality data and related data.</p>
<p>The <strong>deweather</strong> package uses a <em>boosted regression tree</em> approach for modelling air quality data. These and similar techniques provide powerful tools for building statistical models of air quality data. They are able to take account of the many complex interactions between variables as well as non-linear relationships between the variables.</p>
<p>The modelling can be computationally intensive and therefore <strong>deweather</strong> makes use of the parallel processing, which should work on Windows, Linux and Mac OSX.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Installation of <strong>deweather</strong> from GitHub should be easy using the <a href="https://pak.r-lib.org/" class="external-link">pak</a> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"davidcarslaw/deweather"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h2>
<p>Meteorology plays a central role in affecting the concentrations of pollutants in the atmosphere. When considering trends in air pollutants it can be very difficult to know whether a change in concentration is due to emissions or meteorology.</p>
<p>The <strong>deweather</strong> package uses a powerful statistical technique based on <em>boosted regression trees</em> using the <a href="https://github.com/gbm-developers/gbm" class="external-link">gbm</a> package (Ridgeway, 2017). Statistical models are developed to explain concentrations using meteorological and other variables. These models can be tested on randomly withheld data with the aim of developing the most appropriate model.</p>
</div>
<div class="section level2">
<h2 id="example-data-set">Example data set<a class="anchor" aria-label="anchor" href="#example-data-set"></a>
</h2>
<p>The <strong>deweather</strong> package comes with a comprehensive data set of air quality and meteorological data. The air quality data is from Marylebone Road in central London (obtained from the <a href="https://davidcarslaw.github.io/openair/" class="external-link">openair</a> package) and the meteorological data from Heathrow Airport (obtained from the <a href="https://davidcarslaw.github.io/worldmet/index.html" class="external-link">worldmet</a> package).</p>
<p>The <code>road_data</code> data frame contains various pollutants such a NO<sub>x</sub>, NO<sub>2</sub>, ethane and isoprene as well as meteorological data including wind speed, wind direction, relative humidity, ambient temperature and cloud cover. Code to obtain this data directly can be found <a href="https://github.com/davidcarslaw/deweather/blob/master/data-raw/road_data.R" class="external-link">here</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://davidcarslaw.github.io/deweather/">deweather</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">road_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 11</span></span>
<span><span class="co">#&gt;   date                  nox   no2 ethane isoprene benzene    ws    wd air_temp</span></span>
<span><span class="co">#&gt;   &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 1998-01-01 00:00:00   546    74     NA       NA      NA   1     280     3.6 </span></span>
<span><span class="co">#&gt; 2 1998-01-01 01:00:00    NA    NA     NA       NA      NA   1     230     3.5 </span></span>
<span><span class="co">#&gt; 3 1998-01-01 02:00:00    NA    NA     NA       NA      NA   1.5   180     4.25</span></span>
<span><span class="co">#&gt; 4 1998-01-01 03:00:00   944    99     NA       NA      NA  NA      NA    NA   </span></span>
<span><span class="co">#&gt; 5 1998-01-01 04:00:00   894   149     NA       NA      NA   1.5   180     3.8 </span></span>
<span><span class="co">#&gt; 6 1998-01-01 05:00:00   506    80     NA       NA      NA   1     190     3.5 </span></span>
<span><span class="co">#&gt; # ℹ 2 more variables: RH &lt;dbl&gt;, cl &lt;dbl&gt;</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="construct-and-test-models">Construct and test model(s)<a class="anchor" aria-label="anchor" href="#construct-and-test-models"></a>
</h2>
<p>The <code><a href="reference/testMod.html">testMod()</a></code> function is used to build and test various models to help derive the most appropriate.</p>
<p>In this example, we will restrict the data to model to 4 years. Note that variables such as <code>"hour"</code> and <code>"weekday"</code> are used as variables that can be used to explain some of the variation. <code>"hour"</code> for example very usefully acts as a proxy for the diurnal variation in emissions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://davidcarslaw.github.io/openair/" class="external-link">openair</a></span><span class="op">)</span></span>
<span><span class="co"># select only part of the data set</span></span>
<span><span class="va">dat_part</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://davidcarslaw.github.io/openair/reference/selectByDate.html" class="external-link">selectByDate</a></span><span class="op">(</span><span class="va">road_data</span>, year <span class="op">=</span> <span class="fl">2001</span><span class="op">:</span><span class="fl">2004</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># test a model with commonly used covariates</span></span>
<span><span class="fu"><a href="reference/testMod.html">testMod</a></span><span class="op">(</span></span>
<span>  <span class="va">dat_part</span>,</span>
<span>  vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trend"</span>, <span class="st">"ws"</span>, <span class="st">"wd"</span>, <span class="st">"hour"</span>, <span class="st">"weekday"</span>, <span class="st">"air_temp"</span>, <span class="st">"week"</span><span class="op">)</span>,</span>
<span>  pollutant <span class="op">=</span> <span class="st">"no2"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-testMod-1.png" alt="A scatter plot showing predicted nitrogen dioxide on the x-axis and measured nitrogen dioxide on the y-axis. Alongside is a table of statistical values describing the model performance, including R, RMSE, NMGE, NMB, MGE, MB, FAC2 and n." width="100%"><p class="caption">
A statistical summary of a <a href="https://davidcarslaw.github.io/deweather/">deweather</a> model test.
</p>
</div>
<p>The output shows by default the performance of the model when applied to a withheld random 20% (by default) of the data, i.e., the model is evaluated against data not used to build the model. Common model evaluation metrics are also given.</p>
</div>
<div class="section level2">
<h2 id="build-a-model">Build a model<a class="anchor" aria-label="anchor" href="#build-a-model"></a>
</h2>
<p>Assuming that a good model can be developed, it can now be explored in more detail.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_no2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/buildMod.html">buildMod</a></span><span class="op">(</span></span>
<span>  <span class="va">dat_part</span>,</span>
<span>  vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trend"</span>, <span class="st">"ws"</span>, <span class="st">"wd"</span>, <span class="st">"hour"</span>, <span class="st">"weekday"</span>, <span class="st">"air_temp"</span>, <span class="st">"week"</span><span class="op">)</span>,</span>
<span>  pollutant <span class="op">=</span> <span class="st">"no2"</span>,</span>
<span>  n.core <span class="op">=</span> <span class="fl">6</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This function returns a <code>deweather</code> object that can be interrogated as shown below.</p>
</div>
<div class="section level2">
<h2 id="examine-the-partial-dependencies">Examine the partial dependencies<a class="anchor" aria-label="anchor" href="#examine-the-partial-dependencies"></a>
</h2>
<div class="section level3">
<h3 id="plot-all-partial-dependencies">Plot all partial dependencies<a class="anchor" aria-label="anchor" href="#plot-all-partial-dependencies"></a>
</h3>
<p>One of the benefits of the boosted regression tree approach is that the <em>partial dependencies</em> can be explored. In simple terms, the partial dependencies show the relationship between the pollutant of interest and the covariates used in the model while holding the value of other covariates at their mean level.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plotPD.html">plotPD</a></span><span class="op">(</span><span class="va">mod_no2</span>, nrow <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-plotAll-1.png" alt="Seven line charts showing the partial dependencies of the deweather model. In order of influence: wind direction, hour of day, long-term trend, weekday, wind speed, week of the year, and finally air temperature." width="100%"><p class="caption">
The 7 partial dependencies of the deweather model.
</p>
</div>
</div>
<div class="section level3">
<h3 id="plot-two-way-interactions">Plot two-way interactions<a class="anchor" aria-label="anchor" href="#plot-two-way-interactions"></a>
</h3>
<p>It can be very useful to plot important two-way interactions. In this example the interaction between <code>"ws"</code> and <code>"air_temp"</code> is considered. The plot shows that NO<sub>2</sub> tends to be high when the wind speed is low and the temperature is low, i.e., stable atmospheric conditions. Also NO<sub>2</sub> tends to be high when the temperature is high, which is most likely due to more O<sub>3</sub> available to convert NO to NO<sub>2</sub>. In fact, background O<sub>3</sub> would probably be a useful covariate to add to the model.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plot2Way.html">plot2Way</a></span><span class="op">(</span><span class="va">mod_no2</span>, variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ws"</span>, <span class="st">"air_temp"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-plot2way-1.png" alt="A heatmap showing the interaction between air temperature and wind speed in the deweather model. Nitrogen dioixde is shown to be high when wind speed is low and temperature is either very low or above around 25 degrees Celcius." width="100%"><p class="caption">
A two-way interaction plot showing the interaction between wind speed and air temperature
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="apply-meteorological-averaging">Apply meteorological averaging<a class="anchor" aria-label="anchor" href="#apply-meteorological-averaging"></a>
</h2>
<p>An indication of the meteorologically-averaged trend is given by the <code>plotAllPD()</code> function above. A better indication is given by using the model to predict many times with random sampling of meteorological conditions. This sampling is carried out by the <code><a href="reference/metSim.html">metSim()</a></code> function. Note that in this case there is no need to supply the <code>"trend"</code> component because it is calculated using <code><a href="reference/metSim.html">metSim()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">demet</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/metSim.html">metSim</a></span><span class="op">(</span><span class="va">mod_no2</span>,</span>
<span>  newdata <span class="op">=</span> <span class="va">dat_part</span>,</span>
<span>  metVars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ws"</span>, <span class="st">"wd"</span>, <span class="st">"hour"</span>, <span class="st">"weekday"</span>, <span class="st">"air_temp"</span>, <span class="st">"week"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now it is possible to plot the resulting trend.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">demet</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">no2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://davidcarslaw.github.io/openair/reference/quickText.html" class="external-link">quickText</a></span><span class="op">(</span><span class="st">"Deweathered no2 (ug/m3)"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-plotTrend-1.png" alt="A line chart with date on the x-axis and deweathered NO2 on the y-axis. The trend is very noisy, but shows an increase in concentrations in 2003." width="100%"><p class="caption">
A deweathered nitrogen dioxide trend.
</p>
</div>
<p>The plot is rather noisy due to relatively few samples of meteorology being considered (200 by default, set with <code>B = 200</code>). The noise could be reduced by increasing the simulations, but this would add to run time. Alternatively, it can be useful to simply average the results. For example:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://davidcarslaw.github.io/openair/reference/timeAverage.html" class="external-link">timeAverage</a></span><span class="op">(</span><span class="va">demet</span>, <span class="st">"day"</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">no2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"dodgerblue"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://davidcarslaw.github.io/openair/reference/quickText.html" class="external-link">quickText</a></span><span class="op">(</span><span class="st">"Deweathered NO2 (ug/m3)"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-plotTrendAve-1.png" alt="A line chart with date on the x-axis and deweathered NO2 on the y-axis. The trend has been time averaged to show daily mean concentrations, clearly illustrating a sharp increase in 2003." width="100%"><p class="caption">
A time-averaged deweathered nitrogen dioxide trend.
</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li><p>Grange, S. K. and Carslaw, D. C. (2019) <a href="https://www.sciencedirect.com/science/article/pii/S004896971834244X" class="external-link">Using meteorological normalisation to detect interventions in air quality time series</a>, Science of The Total Environment. 653, pp. 578–588. doi: 10.1016/j.scitotenv.2018.10.344.</p></li>
<li><p>Carslaw, D.C., Williams, M.L. and B. Barratt (2012) <a href="https://www.sciencedirect.com/science/article/abs/pii/S1352231012001355" class="external-link">A short-term intervention study — impact of airport closure on near-field air quality due to the eruption of Eyjafjallajökull</a>, Atmospheric Environment, Vol. 54, 328–336.</p></li>
<li><p>Carslaw, D.C. and P.J. Taylor (2009). <a href="https://www.sciencedirect.com/science/article/abs/pii/S1352231009003069" class="external-link">Analysis of air pollution data at a mixed source location using boosted regression trees</a>, Atmospheric Environment. Vol. 43, pp. 3563–3570.</p></li>
<li><p>Greenwell B, Boehmke B, Cunningham J, Developers G (2022). <em>gbm: Generalized Boosted Regression Models</em>. R package version 2.1.8.1, <a href="https://CRAN.R-project.org/package=gbm" class="external-link uri">https://CRAN.R-project.org/package=gbm</a>.</p></li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/davidcarslaw/deweather/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/davidcarslaw/deweather/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing deweather</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>David Carslaw <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/davidcarslaw/deweather/actions" class="external-link"><img src="https://github.com/davidcarslaw/deweather/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://CRAN.R-project.org/package=deweather" class="external-link"><img src="https://www.r-pkg.org/badges/version/deweather" alt="CRAN status"></a></li>
<li><a href="https://github.com/davidcarslaw/deweather/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/davidcarslaw/deweather/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by David Carslaw.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
