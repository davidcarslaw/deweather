[{"path":"http://davidcarslaw.github.io/deweather/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"David Carslaw. Author, maintainer.","code":""},{"path":"http://davidcarslaw.github.io/deweather/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Carslaw D (2023). deweather: Remove influence weather air quality data. http://github.com/davidcarslaw/dweather, http://davidcarslaw.github.io/deweather/.","code":"@Manual{,   title = {deweather: Remove the influence of weather on air quality data},   author = {David Carslaw},   year = {2023},   note = {http://github.com/davidcarslaw/dweather, http://davidcarslaw.github.io/deweather/}, }"},{"path":"http://davidcarslaw.github.io/deweather/index.html","id":"deweather-an-r-package-to-remove-meteorological-variation-from-air-quality-data","dir":"","previous_headings":"","what":"Remove the influence of weather on air quality data","title":"Remove the influence of weather on air quality data","text":"deweather R package developed purpose ‘removing’ influence meteorology air quality time series data. part openair suite packages designed support analysis air quality data related data. deweather package uses boosted regression tree approach modelling air quality data. similar techniques provide powerful tools building statistical models air quality data. able take account many complex interactions variables well non-linear relationships variables. modelling can computationally intensive therefore deweather makes use parallel processing, work Windows, Linux Mac OSX.","code":""},{"path":"http://davidcarslaw.github.io/deweather/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Remove the influence of weather on air quality data","text":"Installation deweather GitHub easy using devtools package.","code":"require(devtools) install_github('davidcarslaw/deweather')"},{"path":"http://davidcarslaw.github.io/deweather/index.html","id":"description","dir":"","previous_headings":"","what":"Description","title":"Remove the influence of weather on air quality data","text":"Meteorology plays central role affecting concentrations pollutants atmosphere. considering trends air pollutants can difficult know whether change concentration due emissions meteorology. deweather package uses powerful statistical technique based boosted regression trees using gbm package (Ridgeway, 2017). Statistical models developed explain concentrations using meteorological variables. models can tested randomly withheld data aim developing appropriate model.","code":""},{"path":"http://davidcarslaw.github.io/deweather/index.html","id":"example-data-set","dir":"","previous_headings":"","what":"Example data set","title":"Remove the influence of weather on air quality data","text":"deweather package comes comprehensive data set air quality meteorological data. air quality data Marylebone Road central London (obtained openair package) meteorological data Heathrow Airport (obtained worldmet package). road_data data frame contains various pollutants NOx, NO2, ethane isoprene well meteorological data including wind speed, wind direction, relative humidity, ambient temperature cloud cover. interested obtaining data directly, following code can used.","code":"library(deweather) head(road_data) #>                  date nox no2 ethane isoprene benzene  ws  wd air_temp       RH #> 1 1998-01-01 00:00:00 546  74     NA       NA      NA 1.0 280     3.60 89.41776 #> 2 1998-01-01 01:00:00  NA  NA     NA       NA      NA 1.0 230     3.50 90.67753 #> 3 1998-01-01 02:00:00  NA  NA     NA       NA      NA 1.5 180     4.25 87.60679 #> 4 1998-01-01 03:00:00 944  99     NA       NA      NA  NA  NA       NA       NA #> 5 1998-01-01 04:00:00 894 149     NA       NA      NA 1.5 180     3.80 89.43347 #> 6 1998-01-01 05:00:00 506  80     NA       NA      NA 1.0 190     3.50 89.40989 #>   cl #> 1  2 #> 2  2 #> 3  2 #> 4 NA #> 5  1 #> 6 NA library(openair) library(worldmet) library(dplyr)  # import AQ data road_data <- importAURN(site = \"my1\",                         year = 1998:2016,                         hc = TRUE)  # import met data met <- importNOAA(year = 1998:2016)  # join together but ignore met data in road_data because it is modelled road_data <-   left_join(select(road_data,-ws,-wd,-air_temp), met, by = \"date\")  road_data <- select(road_data,                     date,                     nox,                     no2,                     ethane,                     isoprene,                     benzene,                     ws,                     wd,                     air_temp,                     RH,                     cl)"},{"path":"http://davidcarslaw.github.io/deweather/index.html","id":"construct-and-test-models","dir":"","previous_headings":"","what":"Construct and test model(s)","title":"Remove the influence of weather on air quality data","text":"testMod function used build test various models help derive appropriate. example, restrict data model 4 years. Note variables hour weekday used variables can used explain variation. hour example usefully acts proxy diurnal variation emissions.  output shows default performance model applied withheld random 20% (default) data .e. model evaluated data nt used build model. Common model evaluation metrics also given.","code":"library(openair) # select only part of the data set dat_part <- selectByDate(road_data, year = 2001:2004)  # test a model with commonly used covariates testMod(dat = dat_part,          vars = c(\"trend\", \"ws\", \"wd\", \"hour\", \"weekday\", \"air_temp\", \"week\"),         pollutant = \"no2\") #> [1] \"Percent increase in RMSE using test data is 1%\""},{"path":"http://davidcarslaw.github.io/deweather/index.html","id":"build-a-model","dir":"","previous_headings":"","what":"Build a model","title":"Remove the influence of weather on air quality data","text":"Assuming good model can developed, can now explored detail. function returns deweather object can interogated shown .","code":"mod_no2 <- buildMod(dat = dat_part,          vars = c(\"trend\", \"ws\", \"wd\", \"hour\", \"weekday\", \"air_temp\", \"week\"),         pollutant = \"no2\",         n.core = 6)"},{"path":[]},{"path":"http://davidcarslaw.github.io/deweather/index.html","id":"plot-all-partial-dependencies","dir":"","previous_headings":"Examine the partial dependencies","what":"Plot all partial dependencies","title":"Remove the influence of weather on air quality data","text":"One benefits boosted regression tree approach partial dependencies can explored. simple terms, partial dependencies show relationship pollutant interest covariates used model holding value covariates mean level.","code":"plotAllPD(dw_model = mod_no2)"},{"path":"http://davidcarslaw.github.io/deweather/index.html","id":"plot-two-way-interactions","dir":"","previous_headings":"Examine the partial dependencies","what":"Plot two-way interactions","title":"Remove the influence of weather on air quality data","text":"can useful plot important two-way interactions. example interaction ws air_temp considered. plot shows NO2 tends high wind speed low temperature low .e. stable atmospheric conditions. Also NO2 tends high temperature high, likely due O3 available convert NO2. fact, background O3 probably useful covariate add model.","code":"plot2Way(dw_model = mod_no2, variable = c(\"ws\", \"air_temp\"))"},{"path":"http://davidcarslaw.github.io/deweather/index.html","id":"apply-meteorological-averaging","dir":"","previous_headings":"","what":"Apply meteorological averaging","title":"Remove the influence of weather on air quality data","text":"indication meteorologically-averaged trend given plotAllPD function . better indication given using model predict many times random sampling meteorological conditions. sampling carried metSim function. Note case need supply “trend” component calculated using metSim. Now possible plot resulting trend.  plot rather noisy due relatively samples meteorology considered (200 default, set B = 200). noise reduced increasing simulations, add run time. Alternatively, can useful simply average results. example:","code":"demet <- metSim(mod_no2, newdata = dat_part,                  metVars = c(\"ws\", \"wd\", \"hour\", \"weekday\", \"air_temp\", \"week\")) library(ggplot2) ggplot(demet, aes(date, pred)) +   geom_line() library(ggplot2) ggplot(timeAverage(demet, \"day\"), aes(date, pred)) +   geom_line(col = \"dodgerblue\", size = 1) +   ylab(quickText(\"no2 (ug/m3)\"))"},{"path":"http://davidcarslaw.github.io/deweather/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Remove the influence of weather on air quality data","text":"Grange, S. K. Carslaw, D. C. (2019) Using meteorological normalisation detect interventions air quality time series, Science Total Environment. 653, pp. 578–588. doi: 10.1016/j.scitotenv.2018.10.344. Carslaw, D.C. P.J. Taylor (2009). Analysis air pollution data mixed source location using boosted regression trees. Atmospheric Environment. Vol. 43, pp. 3563–3570. Carslaw, D.C., Williams, M.L. B. Barratt short-term intervention study — impact airport closure near-field air quality due eruption Eyjafjallajökull. (2012) Atmospheric Environment, Vol. 54, 328–336. Greg Ridgeway contributions others (2017). gbm: Generalized Boosted Regression Models. Rpackage version 2.1.3. (https://CRAN.R-project.org/package=gbm)","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/buildMod.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to apply meteorological normalisation — buildMod","title":"Function to apply meteorological normalisation — buildMod","text":"main function apply gbm model data set.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/buildMod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to apply meteorological normalisation — buildMod","text":"","code":"buildMod(   input_data,   vars = c(\"trend\", \"ws\", \"wd\", \"hour\", \"weekday\", \"temp\"),   pollutant = \"nox\",   sam.size = nrow(input_data),   n.trees = 200,   simulate = FALSE,   B = 100,   n.core = 4,   seed = 123 )"},{"path":"http://davidcarslaw.github.io/deweather/reference/buildMod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to apply meteorological normalisation — buildMod","text":"input_data Data frame analyse. Must contain POSIXct field called date. vars Explanatory variables use. variables used build gbm model. Note model must include trend component. Several variables can automatically calculated (see prepData() details). pollutant name variable apply meteorological normalisation . sam.size number random samples extract data model building. possible use full data set, data sets spanning years model building can take long time run. Additionally, diminishing returns terms model accuracy. sam.size greater number number rows data, number rows data used instead. n.trees Number trees fit. simulate original time series randomly sampled replacement? default FALSE. Setting simulate = TRUE can useful estimating model uncertainties. case models run multiple times B = 1 different value seed e.g. seed = runif(1). B Number bootstrap simulations partial dependence plots. n.core Number cores use parallel processing. seed Random number seed reproducibility returned model.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/buildMod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to apply meteorological normalisation — buildMod","text":"Returns list including model, influence data frame partial dependence data frame.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/buildMod.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Function to apply meteorological normalisation — buildMod","text":"David Carslaw","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/dat.html","id":null,"dir":"Reference","previous_headings":"","what":"Example data for deweather — dat","title":"Example data for deweather — dat","text":"dat dataset provided example dataset part deweather package. dataset contains hourly measurements air pollutant concentrations, wind speed wind direction collected Marylebone (London) air quality monitoring supersite 1st January 1998 23rd June 2005.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/dat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example data for deweather — dat","text":"","code":"dat"},{"path":"http://davidcarslaw.github.io/deweather/reference/dat.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example data for deweather — dat","text":"Data frame 65533 observations (rows) following 10 variables: list(\"date\") Observation date/time stamp year-month-day hour:minute:second format (POSIXct). list(\"ws\") Wind speed, m/s, numeric vector. list(\"wd\") Wind direction, degrees North, numeric vector. list(\"nox\") Oxides nitrogen concentration, ppb, numeric vector. list(\"no2\") Nitrogen dioxide concentration, ppb, numeric vector. list(\"o3\") Ozone concentration, ppb, numeric vector. list(\"pm10\") Particulate PM10 fraction measurement, ug/m3 (raw TEOM), numeric vector. list(\"so2\") Sulfur dioxide concentration, ppb, numeric vector. list(\"co\") Carbon monoxide concentration, ppm, numeric vector. list(\"pm25\") Particulate PM2.5 fraction measurement, ug/m3, numeric vector.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/dat.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Example data for deweather — dat","text":"mydata compiled data archived London Air Quality Archive.  See http://www.londonair.org.uk site details. data also provide '.csv' format via openair project web site http://www.openair-project.org.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/dat.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Example data for deweather — dat","text":"dat supplied rmweather package example dataset use documented examples.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/dat.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Example data for deweather — dat","text":"openair functions generally require data frames field \"date\" can either POSIXct Date format GMT time zone. can hourly data higher resolution data.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/dat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Example data for deweather — dat","text":"","code":"# basic structure head(dat) #>                  date ethane nox no2 o3       ws  wd cl visibility pressure #> 1 2012-01-01 00:00:00   6.09 157  67 22 6.687778 220  8       3500   1008.1 #> 2 2012-01-01 01:00:00   6.71 310  96 12 7.716667 240  8       2900   1008.0 #> 3 2012-01-01 02:00:00   6.73 233  90 16 6.173333 220  5       1500   1008.0 #> 4 2012-01-01 03:00:00   6.49 166  59 20 6.173333 220  5       4000   1007.7 #> 5 2012-01-01 04:00:00   6.69 147  59 26 4.630000 220  4       3500   1007.6 #> 6 2012-01-01 05:00:00   6.99 132  52 26 5.658889 220  6       4000   1007.5 #>   temp   rh rain #> 1 12.2 90.3  0.2 #> 2 12.4 89.2  0.0 #> 3 11.9 93.8  0.0 #> 4 11.8 92.6  0.0 #> 5 11.7 91.4  0.0 #> 6 11.9 90.2  0.0"},{"path":"http://davidcarslaw.github.io/deweather/reference/deweather-package.html","id":null,"dir":"Reference","previous_headings":"","what":"deweather: Remove the influence of weather on air quality data — deweather-package","title":"deweather: Remove the influence of weather on air quality data — deweather-package","text":"Model account (remove) effect meteorology atmospheric composition data. technique uses boosted regression trees based gbm package. Code can also run using multiple cores available.","code":""},{"path":[]},{"path":"http://davidcarslaw.github.io/deweather/reference/deweather-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"deweather: Remove the influence of weather on air quality data — deweather-package","text":"Maintainer: David Carslaw david.carslaw@york.ac.uk","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/diurnalGbm.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot diurnal changes, removing the effect of meteorology — diurnalGbm","title":"Plot diurnal changes, removing the effect of meteorology — diurnalGbm","text":"function calculates diurnal profile pollutant effect meteorology removed. primary use compare two periods determine whether shift diurnal profile e.g. due intervention.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/diurnalGbm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot diurnal changes, removing the effect of meteorology — diurnalGbm","text":"","code":"diurnalGbm(   input_data,   vars = c(\"ws\", \"wd\", \"hour\", \"weekday\"),   pollutant = \"nox\",   dates = c(\"01/01/2012\", \"31/12/2012\", \"31/12/2013\"),   ylab = \"value\" )"},{"path":"http://davidcarslaw.github.io/deweather/reference/diurnalGbm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot diurnal changes, removing the effect of meteorology — diurnalGbm","text":"input_data data frame analyse. vars explanatory variables used model. pollutant Name pollutant apply meteorological normalisation . dates vector dates, length three. dates used partition data two categories (/). date format UK e.g. date = c(\"19/2/2005\", \"19/2/2007\", \"19/2/2010\"). ylab Label y-axis.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/diurnalGbm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot diurnal changes, removing the effect of meteorology — diurnalGbm","text":"data","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/diurnalGbm.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plot diurnal changes, removing the effect of meteorology — diurnalGbm","text":"David Carslaw","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/gbm.interactions.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantify most important 2-way interactions — gbm.interactions","title":"Quantify most important 2-way interactions — gbm.interactions","text":"Quantify important 2-way interactions","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/gbm.interactions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantify most important 2-way interactions — gbm.interactions","text":"","code":"gbm.interactions(res)"},{"path":"http://davidcarslaw.github.io/deweather/reference/gbm.interactions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantify most important 2-way interactions — gbm.interactions","text":"res Model object running buildMod().","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/gbm.interactions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantify most important 2-way interactions — gbm.interactions","text":"Interaction information.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/gbm.interactions.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Quantify most important 2-way interactions — gbm.interactions","text":"David Carslaw","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/gbmInf.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot a GBM influence plot — gbmInf","title":"Plot a GBM influence plot — gbmInf","text":"Plot GBM influence plot","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/gbmInf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot a GBM influence plot — gbmInf","text":"","code":"gbmInf(dat)"},{"path":"http://davidcarslaw.github.io/deweather/reference/gbmInf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot a GBM influence plot — gbmInf","text":"dat Model object running buildMod().","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/gbmInf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot a GBM influence plot — gbmInf","text":"Plot","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/gbmInf.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plot a GBM influence plot — gbmInf","text":"David Carslaw","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/metSim.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to run random meteorological simulations on a gbm model — metSim","title":"Function to run random meteorological simulations on a gbm model — metSim","text":"Function run random meteorological simulations gbm model","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/metSim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to run random meteorological simulations on a gbm model — metSim","text":"","code":"metSim(dw_model, newdata, metVars = c(\"ws\", \"wd\", \"temp\"), n.core = 4, B = 200)"},{"path":"http://davidcarslaw.github.io/deweather/reference/metSim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to run random meteorological simulations on a gbm model — metSim","text":"dw_model Model object running buildMod(). newdata Data set apply model. missing data used build model first place used. metVars variables randomly varied. n.core Number cores use. B Number simulations","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/metSim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to run random meteorological simulations on a gbm model — metSim","text":"add","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/metSim.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Function to run random meteorological simulations on a gbm model — metSim","text":"David Carslaw","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"http://davidcarslaw.github.io/deweather/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/plot2Way.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot two-way interactions from gbm model — plot2Way","title":"Plot two-way interactions from gbm model — plot2Way","text":"Plot two-way interactions gbm model","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/plot2Way.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot two-way interactions from gbm model — plot2Way","text":"","code":"plot2Way(   dw_model,   variable = c(\"ws\", \"temp\"),   res = 100,   exlude = TRUE,   cols = \"default\",   dist = 0.05,   ... )"},{"path":"http://davidcarslaw.github.io/deweather/reference/plot2Way.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot two-way interactions from gbm model — plot2Way","text":"dw_model Model object running buildMod. variable variables plot. Must length two e.g. variables = c(\"ws\", \"wd\". res Resolution x-y .e. number points dimension. exlude surfaces exlude predictions far original data? default TRUE. cols Colours used plotting. Options include “default”, “increment”, “heat”, “jet” user defined. user defined user can supply list colour names recognised R (type colours() see full list). example cols = c(\"yellow\", \"green\", \"blue\") dist plotting surfaces, dist controls far original data predictions made. See exclude..far mgcv package. Data first transformed unit square. Values 0 1. ... arguments passed plotting.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/plot2Way.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot two-way interactions from gbm model — plot2Way","text":"add","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/plot2Way.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plot two-way interactions from gbm model — plot2Way","text":"David Carslaw","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/plotAllPD.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot all partial dependencies — plotAllPD","title":"Plot all partial dependencies — plotAllPD","text":"Plot partial dependencies","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/plotAllPD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot all partial dependencies — plotAllPD","text":"","code":"plotAllPD(dw_model, ylim = NULL, nrow = NULL, ...)"},{"path":"http://davidcarslaw.github.io/deweather/reference/plotAllPD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot all partial dependencies — plotAllPD","text":"dw_model Model object running buildMod. ylim y-axis label. default pollutant name. nrow Number rows plots. ... extra plotting arguments.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/plotAllPD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot all partial dependencies — plotAllPD","text":"plot","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/plotAllPD.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plot all partial dependencies — plotAllPD","text":"David Carslaw","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/plotPD.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to plot partial dependence plots with bootstrap uncertainties — plotPD","title":"Function to plot partial dependence plots with bootstrap uncertainties — plotPD","text":"Function plot partial dependence plots bootstrap uncertainties","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/plotPD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to plot partial dependence plots with bootstrap uncertainties — plotPD","text":"","code":"plotPD(   dat,   variable,   ylim = NULL,   plotit = TRUE,   intervals = 40,   auto.text = TRUE,   ... )"},{"path":"http://davidcarslaw.github.io/deweather/reference/plotPD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to plot partial dependence plots with bootstrap uncertainties — plotPD","text":"dat Model object running buildMod(). variable variable plot. ylim user-specified ylim. plotit plot produced? intervals Number intervals calculate partial dependence . auto.text Either TRUE (default) FALSE. TRUE titles axis labels automatically try format pollutant names units properly e.g.  subscripting `2' NO2. ... arguments plotting.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/plotPD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to plot partial dependence plots with bootstrap uncertainties — plotPD","text":"Invisibly returns list containing plot data used make plot plotPD() plot2Way() allow post processing, e.g., modifying ggplot.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/plotPD.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Function to plot partial dependence plots with bootstrap uncertainties — plotPD","text":"David Carslaw","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/prepData.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to prepare data frame for modelling — prepData","title":"Function to prepare data frame for modelling — prepData","text":"function takes data frame contains field date variables adds common variables needed modelling functions. function run automatically buildMod() can used separately analysis. variables include:","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/prepData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to prepare data frame for modelling — prepData","text":"","code":"prepData(   mydata,   add = c(\"hour\", \"hour.local\", \"weekday\", \"trend\", \"week\", \"jday\", \"month\"),   local.tz = \"Europe/London\",   lag = NULL )"},{"path":"http://davidcarslaw.github.io/deweather/reference/prepData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to prepare data frame for modelling — prepData","text":"mydata data frame process. add Names explanatory variables include. local.tz Used hour needs expressed local time. can useful situations anthropogenic emissions source strong follows local time rather UTC. lag Variables(s) lag. variables included add new columns data frame. example lag = \"ws\" add new columns lag1ws. Adding varaibles can improve explanatory power models. Variables lagged one unit time.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/prepData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to prepare data frame for modelling — prepData","text":"data frame new variables.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/prepData.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Function to prepare data frame for modelling — prepData","text":"hour hour day 0 23. hour.local hour local time zone. Note local time zone need supplied (see local.tz). purpose using local time rather UTC emissions can vary strongly local time rather UTC. weekday day week. trend trend calculated decimal year. week week year. Useful taking account long-term seasonal variations. jday Julian Day number. month month year. Useful taking account long-term seasonal variations.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/prepData.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Function to prepare data frame for modelling — prepData","text":"David Carslaw","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/road_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Example data for deweather — road_data","title":"Example data for deweather — road_data","text":"complete.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/road_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example data for deweather — road_data","text":"","code":"road_data"},{"path":"http://davidcarslaw.github.io/deweather/reference/road_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example data for deweather — road_data","text":"Data frame 65533 observations (rows) following 10 variables: list(\"date\") Observation date/time stamp year-month-day hour:minute:second format (POSIXct). list(\"nox\", \"no2\", \"ethane\", \"isoprene\", \"benzene\") Pollutant concentrations. list(\"pm25\") Particulate PM2.5 fraction measurement, ug/m3, numeric vector. list(\"ws\") Wind speed, m/s, numeric vector. list(\"wd\") Wind direction, degrees North, numeric vector. list(\"air_temp\") Air temperature, degrees Celcius. list(\"RH\") Percentage relative humidity.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/road_data.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Example data for deweather — road_data","text":"deweather compiled data archived London Air Quality Archive.  See http://www.londonair.org.uk site details. data also provide '.csv' format via openair project web site http://www.openair-project.org.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/road_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Example data for deweather — road_data","text":"road_data supplied deweather package example dataset use documented examples.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/road_data.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Example data for deweather — road_data","text":"deweather functions generally require data frames field \"date\" can either POSIXct Date format GMT time zone. can hourly data higher resolution data.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/road_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Example data for deweather — road_data","text":"","code":"# basic structure head(road_data) #>                  date nox no2 ethane isoprene benzene  ws  wd air_temp       RH #> 1 1998-01-01 00:00:00 546  74     NA       NA      NA 1.0 280     3.60 89.41776 #> 2 1998-01-01 01:00:00  NA  NA     NA       NA      NA 1.0 230     3.50 90.67753 #> 3 1998-01-01 02:00:00  NA  NA     NA       NA      NA 1.5 180     4.25 87.60679 #> 4 1998-01-01 03:00:00 944  99     NA       NA      NA  NA  NA       NA       NA #> 5 1998-01-01 04:00:00 894 149     NA       NA      NA 1.5 180     3.80 89.43347 #> 6 1998-01-01 05:00:00 506  80     NA       NA      NA 1.0 190     3.50 89.40989 #>   cl #> 1  2 #> 2  2 #> 3  2 #> 4 NA #> 5  1 #> 6 NA"},{"path":"http://davidcarslaw.github.io/deweather/reference/testMod.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to test different meteorological normalisation models. — testMod","title":"Function to test different meteorological normalisation models. — testMod","text":"Function test different meteorological normalisation models.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/testMod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to test different meteorological normalisation models. — testMod","text":"","code":"testMod(   input_data,   vars = c(\"trend\", \"ws\", \"wd\", \"hour\", \"weekday\", \"temp\"),   pollutant = \"nox\",   train.frac = 0.8,   n.trees = 200,   seed = 123,   plot = TRUE )"},{"path":"http://davidcarslaw.github.io/deweather/reference/testMod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to test different meteorological normalisation models. — testMod","text":"input_data Data frame analyse. vars Explanatory variables use. pollutant name variable apply meteorological normalisation . train.frac Fraction data train model . model tested withheld 0.2 proportion. n.trees Number trees use. seed Random number seed reproducibility returned model. plot default, TRUE, automatically prints plot two tables statistics review model output. FALSE disables behaviour.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/testMod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to test different meteorological normalisation models. — testMod","text":"Returns added.","code":""},{"path":"http://davidcarslaw.github.io/deweather/reference/testMod.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Function to test different meteorological normalisation models. — testMod","text":"David Carslaw","code":""}]
